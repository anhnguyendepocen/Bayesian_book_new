\documentclass[11pt,fullpage]{book}
\title{\textbf{~~~~~~~~~~~~~~~}\newline Bayesian book: problem sets}
\author{Ben Lambert}
\usepackage{natbib}
\usepackage{appendix}
\usepackage{url,times}
\usepackage{graphicx}
\usepackage{epstopdf}
\usepackage{amsmath}
\usepackage[all]{xy}
\usepackage{pxfonts}
\usepackage{colortbl}
\usepackage{color}
\usepackage{subfigure}
\usepackage{gensymb}
\usepackage{ctable}
\usepackage[justification=centering]{caption}[2007/12/23]
\usepackage{longtable}
\usepackage{pstricks-add}
\usepackage{pstricks}
\usepackage{pst-func}
\usepackage{pst-math}


\setlength{\parindent}{0.0in}
\setlength{\parskip}{0.1in}
\maketitle

\begin{document}
\bibliographystyle{plain}
\bibliography{Bayes}

\chapter{Probability}
\section{The Bayesian game show}
This question hinges on deriving the distribution of outcomes under either staying put, or changing, after the game show host has opened the empty door. This can be answered through application of Bayes' rule, but I prefer here to describe more intuitively what is happening.

Imagine we are considering repeating the show a number of times. We can imagine three possibilities for the initial choice of door:

\begin{itemize}
\item $\frac{1}{4}$ of the time, the door hides the car.
\item $\frac{1}{2}$ of the time, the door hides a null.
\item $\frac{1}{4}$ of the time, the door hides the penalty.
\end{itemize}

Considering now each of these in turn: 

If the door contains the car, then the other three doors are two nulls, and the penalty. The game show host opens one of the nulls, meaning that only one null and the penalty remain. In this circumstance, if you stay put, you definitely obtain the car. If you change, you get a null with probability $\frac{1}{2}$ and similarly for the penalty.

If the door contains a null, then the other three doors are one null, one penalty and one car. When the host opens the remaining null, then the other two doors are the car, and the penalty. This is the key step. By staying put, you gain/lose nothing, whereas if you change you face risk; you get the car with probability $\frac{1}{2}$ and similarly for the penalty. Both of these choices have the same expected payoff, but the latter increases risk.

Finally, if the door contains the penalty, then the other three doors are two nulls, and the car. The game show host opens one of the nulls, meaning that only one null and the car remain. In this circumstance, if you stay put, you definitely obtain the penalty. If you change, you get a null with probability $\frac{1}{2}$ and similarly for the car.

We can now write down probability distributions for the outcomes given each possible action. For staying put, the probabilities are what they were if you hadn't received any new information, in other words $(p(car),p(null),p(penalty)=(\frac{1}{4},\frac{1}{2},\frac{1}{4})$. Whereas if you change:

\begin{equation}
\begin{align}
\item p(car) &= \frac{1}{4} \times 0 + \frac{1}{2}\times \frac{1}{2} + \frac{1}{4} \times \frac{1}{2} = \frac{3}{8}\\
p(null) &=  \frac{1}{4} \frac{1}{2} + \frac{1}{2}\times\times 0 + \frac{1}{4} \times \frac{1}{2} = \frac{2}{8}\\
p(penalty) &=  \frac{1}{4} \times \frac{1}{2} + \frac{1}{2}\times \frac{1}{2} + \frac{1}{4} \times 0 = \frac{3}{8}
\end{align}
\end{equation}

So in summary, we get face $(p(car),p(null),p(penalty)=(\frac{3}{8},\frac{2}{8},\frac{3}{8})$ by changing. 

Both of these two outcomes face the same expected return of \$0:

\begin{equation}
\begin{align}
\mathrm{E}[return|stay] &= \frac{1}{4} \times \$ 1,000 + \frac{1}{2} \times \$ 0 + \frac{1}{4} \times -\$1,000\\
&= \$ 0
\end{align}
\end{equation}

\begin{equation}
\begin{align}
\mathrm{E}[return|change] &= \frac{3}{8} \times \$ 1,000 + \frac{2}{8} \times \$ 0 + \frac{3}{8} \times -\$1,000\\
&= \$ 0
\end{align}
\end{equation}

However, what is different is the variance in return from each decision. The variance in return is greater by changing, than it is by staying, since the latter has more weight on the risky outcomes. Obviously, these can be calculated explicitly using the same methodology as above.

If the individual is risk-averse, then he prefers the less risky outcome of \textit{staying put}, given that they both have the same return. 

If you still aren't convinced by this reasoning, see the Mathematica file XXX which compares these two strategies over time. If the reward value is increased, then changing becomes relatively more attractive, and vice versa if the cost is increased. This makes sense since we want to choose a riskier option when the reward is higher, and a less riskier option when the cost increases. When we increase the null value we want to choose the option which returns this value more frequently; staying put.

\section{Blood doping}
\begin{table}[htbp]
  \centering
    \begin{tabular}{ccc}
    \toprule
          & \textbf{Lost} & \textbf{Won} \\
    \midrule
    \textbf{Clean} & 0.7   & 0.05 \\
    \textbf{Doping} & 0.15  & 0.15 \\
    \bottomrule
    \end{tabular}%
    \caption{The historical probabilities of behaviour and outcome for professional cyclists.}
  \label{tab:Probability_PS_bloodDoping}%
\end{table}%

Suppose as a benign omniscient observer, we tally up the historical cases where professional cyclists used/didn't-use blood doping, and either won or lost a particular race. This results in the probability distribution shown in table \ref{tab:Probability_PS_bloodDoping}.

Tables \ref{tab:Probability_dopingNormal} and \ref{tab:Probability_dopingInverted} can be calculated using conditional probabilities make the questions easier to handle.

% Table generated by Excel2LaTeX from sheet 'Sheet1'
\begin{table}[htbp]
  \centering
    \begin{tabular}{ccc}
    \toprule
    & \textbf{Lost} & \textbf{Won} \\
    \midrule
    \textbf{Clean} & 0.93  & 0.067 \\
    \textbf{Doping} & 0.60  & 0.40 \\
    \bottomrule
    \end{tabular}%
  \caption{The probability of outcomes given a drug status.}%
  \label{tab:Probability_dopingNormal}
\end{table}%


% Table generated by Excel2LaTeX from sheet 'Sheet1'
\begin{table}[htbp]
  \centering
    \begin{tabular}{ccc}
    \toprule
     \textbf{Lost} & \textbf{Won} \\
    \midrule
    \textbf{Clean} & 0.82  & 0.33 \\
    \textbf{Doping} & 0.18  & 0.67 \\
    \bottomrule
    \end{tabular}%
  \caption{The probability of a drug status given an outcome.}%
  \label{tab:Probability_dopingInverted}
\end{table}%


\subsection{What is the probability that a professional cyclist wins a race?}
This is the marginal given by: $p(won) = p(won,dope) + p(won,clean) = 0.05 + 0.1 = 0.15$

\subsection{What is the probability that a cyclist wins a race given that they have cheated?}
This is  a conditional distribution given by:

\begin{equation}
\begin{align}
p(won|doped) &= \frac{p(doped,won)}{p(doped)}\\
&= \frac{0.1}{0.25} = 0.4
\end{align}
\end{equation}

\subsection{What is the probability that a cyclist is cheating given that he wins?}
Use Bayes' rule:

\begin{equation}
\begin{align}
p(doped|won) &= \frac{p(won|doped)p(doped)}{p(won)}\\
&= \frac{0.4\times 0.25}{0.15}\\
&= \frac{2}{3}
\end{align}
\end{equation}


Now suppose that drug testing officials have a test which is relatively accurate in finding cheats. It accurately indicates a blood-doper 90\% of the time. However, it incorrectly indicates a positive for clean athletes 5\% of the time. 

Should the officials test all the athletes or only the winners, for the cases when:

\subsection{They care only about the proportion of people correctly identified as dopers}
Here we want to compare $p(doped|positive,group)$ across $group\in\{everyone,winners\}$. For everyone, this is simple and given by:

\begin{equation}
\begin{align}
p(doped|positive) &= \frac{p(positive|doped)p(doped)}{p(positive)}\\
&= \frac{p(positive|doped)p(doped)}{p(positive,doped) + p(positive,clean)}\\
&= \frac{p(positive|doped)p(doped)}{p(positive|doped)p(doped) + p(positive|clean)p(clean)}\\
&= \frac{0.9\times 0.25}{0.9\times 0.25 + 0.05\times 0.75}\\
&\approx 0.86
\end{align}
\end{equation}

Whereas for the winners:

\begin{equation}
\begin{align}
p(doped|positive,won) &= \frac{p(doped,positive|won)}{p(positive|won)}\\
\end{align}
\end{equation}

We will proceed to calculate each of these bits in turn. Via Bayes' rule:
\begin{equation}
\begin{align}
p(doped,positive|won) &= \frac{p(won|doped,positive)p(doped,positive)}{p(won)}\\
&= \frac{p(won|doped)p(doped,positive)}{p(won)}\\
&= \frac{p(won|doped)p(positive|doped)p(doped)}{p(won)}\\
&= \frac{0.4 \times 0.9 \times 0.25}{0.15}\\
&= 0.6
\end{align}
\end{equation}

We have got the second line from the first, by assuming that there is a conditional independence between winning and testing positive, once we account for their drug status. This is a fairly safe assumption, unless of course winners are more effective at hiding their drug use!

Now for the last bit:

\begin{equation}
\begin{align}
p(positive|won) &= p(positive,doped|won) + p(positive,clean|won)\\
&= p(positive|doped,won) p(doped|won) + p(positive|clean,won) p(clean|won)\\
&= p(positive|doped) p(doped|won) + p(positive|clean) p(clean|won)\\
&= 0.9\times \frac{2}{3} + 0.05\times \frac{1}{3}\\
&\approx 0.62
\end{align}
\end{equation}

Combining these two, we have $p(doped|positive,won) = \frac{0.6}{0.62} \approx 0.97$. Hence we should only test the winners. This makes intuitive sense, since they are a group which have a higher than average percentage of dopers. 

\subsection{They want only to minimise the proportion of falsely accused athletes}
Here we want to minimise $p(clean|positive,group)$, where again $group\in\{everyone,winners\}$. For everyone, this is achieved through Bayes' rule:\\

\begin{equation}
\begin{align}
p(clean|positive) &= \frac{p(positive|clean) p(clean)}{p(positive)}\\
&= \frac{0.05\times 0.75}{0.9\times 0.25 + 0.05\times 0.75}\\
&\approx 0.14
\end{align}
\end{equation}

Whereas for the winners' group:

\begin{equation}
\begin{align}
p(clean|positive,won) = \frac{p(positive,won|clean)p(clean)}{p(positive,won)}\\
&= \frac{p(positive|clean)\times p(won|clean) p(clean)}{p(positive,won)}\\
&= \frac{p(positive|clean)\times p(won|clean) p(clean)}{p(positive|won) p(won)}\\
&= \frac{0.05\times 0.07\times 0.75}{0.62\times 0.15}\\
&\approx 0.03
\end{align}
\end{equation}

Where we have got the second line from the first by assuming conditional independence of testing and outcome given a drug status.

Hence we should choose the winners' group again.

\subsection{They care only about the \textit{number} of people correctly identified as dopers}
Here what we care about is the expected $n(doped|positive,group) = n(group)\times p(doped|positive,group)$ across $group\in\{everyone,winners\}$. For everyone, this is given by:

\begin{equation}
\begin{align}
n(doped|positive) &= n(total) \times p(doped|positive)\\
&= 0.86 n(total)
\end{align}
\end{equation}

Whereas for the winners:

\begin{equation}
\begin{align}
n(doped|positive,won) &= n(won) \times p(doped|positive,won)\\
&= n(won)\times p(doped|positive,won)\\
&= n(total)\times p(won)\times p(doped|positive,won)\\
&= n(total)\times 0.15 \times 0.97\\
&= 0.15 n(total)
\end{align}
\end{equation}

Therefore in this circumstance, we should test everyone! This makes intuitive sense, since the latter is a subset of the former.

\subsection{They care five times about the \textit{number} of people who are falsely identified as they do about the \textit{number} of people who are correctly identified as dopers}

Now we need to specify a utility function of the form:

\begin{equation}
\begin{align}
U(group) &= n(doped|positive,group) - 5 n(clean|positive,group)\\
&= n(group)\left[p(doped|positive,group) - 5 p(clean|positive,group)\right]\\
&= n(group)\left[p(doped|positive,group) - 5 (1-p(doped|positive,group))\right]\\
&= n(total)\left[6 p(doped|positive,group) - 5\right]
\end{align}
\end{equation}

Calculating this for everyone, we have:

\begin{equation}
\begin{align}
U(total) &= n(total)\left[6 p(doped|positive) - 5\right]\\
&\approx n(total)\left[6\times 0.86 - 5\right]\\
&\approx 0.14 n(total)
\end{align}
\end{equation}

For only the winners' group, we have:

\begin{equation}
\begin{align}
U(won) &= n(total)\times p(won)\left[6 p(doped|positive,won) - 5\right]\\
&\approx n(total) \times 0.15 \left[6 \times 0.97 - 5\right]\\
&\approx 0.13 n(total)
\end{align}
\end{equation}

So in this case they should test everyone.

\subsection{What factor would make the officials choose the other group? (By factor, we mean the number 5 in the previous question.)}
They want the number $\alpha$ which makes the utility from testing the winners' group exceed that of testing everyone $U(won) > U(total)$ \implies

\begin{equation}
\begin{align}
n(total)\left[\alpha p(doped|positive) - 5\right] > n(total)p(won)\left[\alpha p(doped|positive,won) - 5\right]\\
\end{align}
\end{equation}

We can remove the factor of $n(total)$ since it appears on both sides. Rearranging, we are then left with:

\begin{equation}
\begin{align}
\alpha > \frac{5\left[1-p(won)\right]}{p(doped|positive) - p(won) p(doped|positive,won)}
\end{align}
\end{equation}

Which, when you substitute in the numbers yields $\alpha > 5.97$. 

\end{document}